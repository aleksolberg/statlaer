---
subtitle: "TMA4268 Statistical Learning V2022"
title: "Compulsory exercise 2: Group 5"
author: "Aleksander Johnsen Solberg and Gjermund Oscar Lyckander"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  # html_document
  pdf_document
---
  
```{r setup, include=FALSE}
library(knitr)
knitr::opts_chunk$set(echo = TRUE,tidy=TRUE,message=FALSE,warning=FALSE,strip.white=TRUE,prompt=FALSE,
                      cache=TRUE, size="scriptsize",fig.width = 6, fig.height = 3, fig.align = "center")
```

```{r,eval=TRUE,echo=FALSE}
#install.packages("ggplot2")
#install.packages("tidyverse")
#install.packages("palmerpenguins")
#install.packages("GGally")
#install.packages("MASS")
#install.packages("caret")
#install.packages("leaps")
#install.packages("glmnet")
#install.packages("pls")
#install.packages("gam")
#install.packages("e1071")
#install.packages("tree")
#install.packages("randomForest")
#install.packages("ggfortify")
#install.packages('tikz')
library("knitr")
library("rmarkdown")
library('MASS')
library(leaps)
library(ggplot2)
library(GGally)
library(glmnet)
library(gam)
library(tikzDevice)
```

<!--  Etc (load all packages needed). -->


# Problem 1

```{r, eval=TRUE,echo=TRUE}
set.seed(1)
boston <- scale(Boston, center = T, scale =  T)

train.ind = sample(1:nrow(boston), 0.8 * nrow(boston))
boston.train = data.frame(boston[train.ind, ])
boston.test = data.frame(boston[-train.ind, ])
```
## a)
```{r, eval=TRUE,echo=TRUE}
set.seed(1)
forward_stepwise = regsubsets(medv ~ ., data = boston.train, nvmax = 13, method = 'forward')
backward_stepwise = regsubsets(medv ~ ., data = boston.train, nvmax = 13, method = 'backward')

forward_stepwise_summary = summary(forward_stepwise)
backward_stepwise_summary = summary(backward_stepwise)
#forward_stepwise_summary
#backward_stepwise_summary

par(mfrow=c(1,2))
plot(forward_stepwise_summary$adjr2, xlab = '# variables', ylab = 'Adjusted R^2', type='l', main='Forwards')
plot(forward_stepwise_summary$adjr2, xlab = '# variables', ylab = 'Adjusted R^2', type='l', main='Backwards')

```


## b)
```{r, eval=TRUE,echo=TRUE}
forward_stepwise_summary$outmat
```
We choose the predictors 'rm, 'dis', 'ptratio' and 'lstat'.

## c)
### i)
```{r, eval=TRUE,echo=TRUE}
set.seed(1)
y = boston.train$medv
x = data.matrix(boston.train[, -14])

cv_lasso = cv.glmnet(x, y, alpha=1, nfolds=5)
plot(cv_lasso)
```
### ii)
```{r, eval=TRUE,echo=TRUE}
lasso_best_lambda = cv_lasso$lambda.min
lasso_best_lambda
```
### iii)
```{r, eval=TRUE,echo=TRUE}
coef(glmnet(x, y, alpha=1, lambda=lasso_best_lambda))
```


## d)
### i) TRUE
### ii) FALSE
### iii) FALSE
### iv) TRUE
 

# Problem 2

## a)

## b)


# Problem 3

## a)
### i) TRUE
### ii) FALSE
### iii) FALSE
### iv) TRUE

## b)
```{r, eval=TRUE,echo=TRUE}
additive_model = gam(medv ~ rm + s(ptratio, df=3) + poly(lstat, 2), data=boston.train)
plot(additive_model)
```


# Problem 4

## a) 
### i) FALSE
### ii) TRUE
### iii) TRUE
### iv) TRUE

## b)
![Tree](Tree.png){width=200}

## c)
testest 
